{# Modificado para que agregar el botón para ir al listado #}

{% extends 'IndicadoresBundle::standard_layout_tablero.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
<link rel="stylesheet" href="{{ asset('bundles/indicadores/css/FichaTecnicaAdmin/tablero.css') }}" type="text/css" media="all" />

<link rel="stylesheet" href="{{ asset('bundles/indicadores/js/DataTables/media/css/TableTools.css') }}" type="text/css" media="all" />
<link rel="stylesheet" href="{{ asset('bundles/indicadores/js/bootstrap/css/summernote.css') }}" type="text/css" media="all" />
<link rel="stylesheet" href="{{ asset('bundles/indicadores/js/DataTables/media/css/jquery.dataTables.css') }}" type="text/css" media="all" />
<!--EDITADO PARA NUEVOS TIPOS DE GRAFICOS (CSS)-->
<link rel="stylesheet" href="{{ asset('bundles/indicadores/css/datepicker.css') }}" type="text/css" media="all" />
    <link rel="stylesheet" href="{{ asset('bundles/indicadores/css/FichaTecnicaAdmin/gauge.css') }}" type="text/css" media="all" />
    <link rel="stylesheet" href="{{ asset('bundles/indicadores/js/handsontable/handsontable.css') }}" type="text/css" media="all" />


{% endblock %}

{% block javascripts %}
    {{ parent() }}
<script src="{{ asset('bundles/indicadores/js/d3.min.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/d3pie.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/affix.min.js') }}" type="text/javascript"></script>

<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_pastel.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_columnas.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_lineas.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/tablero.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/comun.js') }}" type="text/javascript"></script>

<script src="{{ asset('bundles/indicadores/js/bootstrap/js/moment.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/bootstrap/js/summernote.js') }}" type="text/javascript"></script>

    <!--EDITADO PARA NUEVOS TIPOS DE GRAFICOS-->
    <script src="{{ asset('bundles/indicadores/js/SVG/rgbcolor.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/SVG/StackBlur.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/SVG/canvg.js') }}" type="text/javascript"></script>
    
    <script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_gauge.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_termometro.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/iopctrl.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_mapa.js') }}" type="text/javascript"></script>
	
    <script src="{{ asset('bundles/indicadores/js/bridge_draggable_touch.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/jquery.ui.touch-punch.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/rasterizeHTML.allinone.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/DataTables/jquery.dataTables.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/DataTables/ZeroClipboard.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/DataTables/TableTools.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/bootstrap/js/bootstrap-datepicker.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/handsontable/handsontable.full.js') }}" type="text/javascript"></script>
<script>
function JSONToCSVConvertor(JSONData, ReportTitle, ShowLabel) {
    //If JSONData is not an object then JSON.parse will parse the JSON string in an Object
    var arrData = typeof JSONData != 'object' ? JSON.parse(JSONData) : JSONData;
    
    var CSV = '';    
    //Set Report title in first row or line
    
    CSV += ReportTitle + '\r\n\n';

    //This condition will generate the Label/Header
    if (ShowLabel) {
        var row = "";
        
        //This loop will extract the label from 1st index of on array
        for (var index in arrData[0]) {
            
            //Now convert each value to string and comma-seprated
            row += index + ',';
        }

        row = row.slice(0, -1);
        
        //append Label row with line break
        CSV += row + '\r\n';
    }
    
    //1st loop is to extract each row
    for (var i = 0; i < arrData.length; i++) {
        var row = "";
        
        //2nd loop will extract each column and convert it in string comma-seprated
        for (var index in arrData[i]) {
            row += '"' + arrData[i][index] + '",';
        }

        row.slice(0, row.length - 1);
        
        //add a line break after each row
        CSV += row + '\r\n';
    }

    if (CSV == '') {        
        alert("Invalid data");
        return;
    }   
    
    //Generate a file name
    var fileName = "MyReport_";
    //this will remove the blank-spaces from the title and replace it with an underscore
    fileName += ReportTitle.replace(/ /g,"_");   
    
    //Initialize file format you want csv or xls
    var uri = 'data:text/csv;charset=utf-8,' + escape(CSV);
    
    // Now the little tricky part.
    // you can use either>> window.open(uri);
    // but this will not work in some browsers
    // or you will not get the correct file extension    
    
    //this trick will generate a temp <a /> tag
    var link = document.createElement("a");    
    link.href = uri;
    
    //set the visibility hidden so it will not effect on your web-layout
    link.style = "visibility:hidden";
    link.download = fileName + ".csv";
    
    //this part will append the anchor tag and remove it after automatic click
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
$(document).ready(function(){
    var $container = $("#handsontable");
    container = document.getElementById('handsontable');
    var handsontable = $container.data('handsontable'); 
var config = {
    height: 396,
    width:1300,
    minRows: 0,
    minCols: 14,
    minSpareRows: 1,
    autoWrapRow: true,
    colHeaders:["Id","Indicadores","ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],
    currentRowClassName: 'currentRow',
    currentColClassName: 'currentCol',
    contextMenu: {
        items: {
            "row_above": {},
                "row_below": {},
                "hsep1": "---------",
                "col_left": {},
                "col_right": {},
                "hsep2": "---------",
                "remove_row": {},
                "remove_col": {}
        }
    }
};   //data:advancedData,
var hot = new Handsontable(container, {
                                            
                                            height: 396,
                                            width:1300,
                                            colHeaders:["Id","Indicadores","ene","feb","mar","abr","may","jun","jul","ago","sept","oct","nov","dic"],
                                            rowHeaders: true,
                                            stretchH: 'all',
                                            contextMenu: true,
                                            readOnly: false,
                                            columns: [
                                            {data: "id", type: 'numeric', format: '0',readOnly: true, width:50 },  
                                            {data: "descripcion", type: 'text', readOnly: true, width:400},
                                            {data: "ene", type: 'numeric',readOnly: false, width:50 },
                                            {data: "feb", type: 'numeric',readOnly: false, width:50 },
                                            {data: "mar", type: 'numeric',readOnly: false, width:50 },
                                            {data: "abr", type: 'numeric',readOnly: false, width:50 },
                                            {data: "may", type: 'numeric',readOnly: false, width:50 },
                                            {data: "jun", type: 'numeric',readOnly: false, width:50 },
                                            {data: "jul", type: 'numeric',readOnly: false, width:50 },
                                            {data: "ago", type: 'numeric',readOnly: false, width:50 },
                                            {data: "sep", type: 'numeric',readOnly: false, width:50 },
                                            {data: "oct", type: 'numeric',readOnly: false, width:50 },
                                            {data: "nov", type: 'numeric',readOnly: false, width:50 },
                                            {data: "dic", type: 'numeric',readOnly: false, width:50 },
                                            ]
                                            });          

    $('#dated01').datepicker({
        pickTime:false,
        format: "MM-yyyy",
        minViewMode: 1 
    }); 
 //href();
	$("#search_").autocomplete({
		source: "{{ path('autoComplete_Indicador') }}",
		select: function (a, b) 
		{
			var valor=b.item.value;
			valor=valor.split("]")[0];
			valor=valor.split("[")[1];	
			sala_agregar_fila(); 								
			recuperarDimensiones(valor, null);
		},
		position: {
			my : "right top",
			at: "right bottom"
		}
	});
	$('#search_').click(function() {
        this.value="";
    });
//LLENADO MUNICIPIO
        $('#ddl01').change(function(e) {
         // href();
        });
         $('#ddl02').change(function(e) {
          //href();
        });
//LLENADO USUARIO_ESTABLECIMIENTOS YA GUARDADOS
        $('#ddl04').change(function(e) {
           // href();
          e.preventDefault(); 
                        var param =  "'"+$("#ddl04").val()+"'/";
                        url="/sesal/web/app_dev.php/buscarEstablecimientoU/" + param;
                         //url="/sigep/web/app_dev.php/catdepartamento/buscarMunicipio/" + param;
                         
			$.ajax({
                                type:'POST',
				url:url,
                                beforeSend: function(){
				$("#lblError").hide();	
				},
                                dataType: 'json',
				success:function(data){
					if(data.message === 'false'){
                                            alert('false');
					}else{
                                             var ejercicio = "<option value='0'> --TODOS LOS ESTABLECIMIENTOS-- </option>";
                                             var valorInicial = "<option value=' '> --OPCIÓN-- </option>";
                                             $.each(data, function(i) {
                                              ejercicio = ejercicio + "<option value='"+data[i].id+"'>"+data[i].id+ " - "+data[i].nombre+ " - "+data[i].codigo+ " - "+data[i].nm+"</option>";  
                                              });
                                              $('#ddl01').html(ejercicio); 
                                        }
				}
			});
        });
        $("#btnExport").click(function(e) {
        //window.open('data:application/vnd.ms-excel,' + JSON.stringify(hot.getData()));
        e.preventDefault(); 
                        var param =  ""+$("#ddl04").val() +
                                     ","+$("#ddl01").val() +
                                     ","+$("#ddl02").val() +
                                     "/";
                        url="/sesal/web/app_dev.php/reporterexcel/" + param;
                         //url="/sigep/web/app_dev.php/catdepartamento/buscarMunicipio/" + param;
                         
			$.ajax({
                                type:'POST',
				url:url,
                                beforeSend: function(){
				$("#lblError").hide();	
				},
                                dataType: 'json',
				success:function(data){
					if(data.message === 'false'){
                                            alert('false');
					}else{
                                             //var ejercicio = "<option value='0'> --TODOS LOS ESTABLECIMIENTOS-- </option>";
                                             //var valorInicial = "<option value=' '> --OPCIÓN-- </option>";
                                             var data= JSON.stringify(data);
                                             JSONToCSVConvertor(data, "Indicadores Establecimientos", true);
                                             e.preventDefault();
                                             //$.each(data, function(i) {
                                             // ejercicio = ejercicio + "<option value='"+data[i].id+"'>"+data[i].id+ " - "+data[i].nombre+ " - "+data[i].codigo+ " - "+data[i].nm+"</option>";  
                                             // });
                                             // $('#ddl01').html(ejercicio); 
                                        }
				}
			});
        
        
        
        
    });
    //function href(){
    //    var d= "/sesal/web/app_dev.php/crearReporte/"+ $("#ddl04").val()+ "," + $("#ddl01").val()+ "," + $("#ddl02").val()+ "/" 
    //    document.getElementById("btnCargar").href= d;   
    //}
    
  $('#btnCargar').click(function(e) {
         var fecha= $("#ddl02").val(); ;//$("#dated01").val().replace(/\//g, '+*)');
         var Est = $("#ddl01").val();
         
         var param = fecha + "&&" +     
	  Est+ "/"; 
           url="/sesal/web/app_dev.php/fornpm/"+ param;
         
			$.ajax({
                                type:'POST',
				url:url,
                                beforeSend: function(){
				$("#lblError").hide();	
				},
                                dataType: 'json',
				success:function(data){
					if(data.message== 'false'){
                                            //alert('false');
                                            advancedData = [["","","","","","","","","","","","","",""]]; 
                                            //advancedData=data.message;
                                            hot.loadData(advancedData);
                                            $container = document.getElementById('handsontable');
                                            //hot;
                                            //alert(advancedData);
					}else{
                                            advancedData=data.message;
                                            
                                            
                                            
                                            
                                            $container = document.getElementById('handsontable');
                                            //alert(data.mes);
                                            var mes= data.mes;
                                            switch(mes){
                                                case '01':

                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400},
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ], cells: function (row, col, prop) { 
                                                var cellProperties = {}; 
                                                 var resP = data.message;
                                                    cellProperties.renderer = function (instance, td, row, col, prop, value, cellProperties) { 
                                                        Handsontable.cellTypes[cellProperties.type].renderer.apply(this, arguments); 
                                                       if (resP[row] != undefined){
                                                        //if (resP[row]['pintar']='rojo'){ 
                                                           if(col== 2){
                                                                 if (resP[row]['epintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['epintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['epintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 } 
                                                           }  
                                                            if(col== 3){
                                                                 if (resP[row]['fpintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['fpintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['fpintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                            if(col== 4){
                                                                 if (resP[row]['mpintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['mpintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['mpintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }
                                                             }
                                                            if(col== 5){
                                                                 if (resP[row]['bpintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['bpintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['bpintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 } 
                                                             }
                                                             if(col== 6){
                                                                 if (resP[row]['ypintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['ypintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['ypintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           }
                                                           if(col== 7){
                                                                 if (resP[row]['jpintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['jpintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['jpintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                           if(col== 8){
                                                                 if (resP[row]['lpintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['lpintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['lpintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                           if(col== 9){
                                                                 if (resP[row]['apintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['apintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['apintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                           if(col== 10){
                                                                 if (resP[row]['spintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['spintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['spintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                           if(col== 11){
                                                                 if (resP[row]['opintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['opintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['opintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                           if(col== 12){
                                                                 if (resP[row]['npintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['npintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['npintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                           if(col== 13){
                                                                 if (resP[row]['dpintar']=='verde'){
                                                                    td.style.backgroundColor= '#70db70'; 
                                                                 }
                                                                 if (resP[row]['dpintar']=='naranja'){
                                                                    td.style.backgroundColor= '#ffcc66'; 
                                                                 }
                                                                 if (resP[row]['dpintar']=='rojo'){
                                                                    td.style.backgroundColor= '#ff4d4d'; 
                                                                 }  
                                                           } 
                                                        //}else{
                                                        //     td.style.backgroundColor= '#ffffff'; 
                                                        //}
                                                    }}
                                                return cellProperties; }
                                        });
                                            break;
                                               case '02':

                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: false, width:50,color:'red' },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50, hidden:'true'},
                                            ], });
                                            break;
                                               case '03':

                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: false, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                             case '04':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: false, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                              case '05':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: false, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                              case '06':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: false, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                               case '07':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: false, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                             break;
                                               case '08':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: false, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                               case '09':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: false, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                               case '10':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: false, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                               case '11':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: false, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                            break;
                                               case '12':
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: false, width:50 },
                                            ]});
                                            break;
                                            default:
                                            
                                            hot.updateSettings({columns: [
                                             {data: "id", type: 'numeric', readOnly: true, width:50, format: '0' },  
                                             {data: "descripcion",type: 'text', readOnly: true, width:400   },
                                             {data: "ene", type: 'numeric',readOnly: true, width:50 },
                                             {data: "feb", type: 'numeric',readOnly: true, width:50 },
                                             {data: "mar", type: 'numeric',readOnly: true, width:50 },
                                             {data: "abr", type: 'numeric',readOnly: true, width:50 },
                                             {data: "may", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jun", type: 'numeric',readOnly: true, width:50 },
                                             {data: "jul", type: 'numeric',readOnly: true, width:50 },
                                             {data: "ago", type: 'numeric',readOnly: true, width:50 },
                                             {data: "sep", type: 'numeric',readOnly: true, width:50 },
                                             {data: "oct", type: 'numeric',readOnly: true, width:50 },
                                             {data: "nov", type: 'numeric',readOnly: true, width:50 },
                                             {data: "dic", type: 'numeric',readOnly: true, width:50 },
                                            ]});
                                        break;
                                           }
                                            hot.loadData(advancedData);
                                            
                                            
                                            
                                            //alert('2');
                                            //hot;
                                            //alert(advancedData);
                                            
                                            
                                           
                      }
                  }
              });
              
          });
    
    
    
});
</script>
<style>
.ui-autocomplete { max-height: 200px; overflow:visible; z-index:999999999}
</style>
{% endblock %}

{% block content %}
<div class="container-fluid" id="contenedor_tablero">
    <form id="login-form"  name="login-form" class="login-form" method="POST">
        <div class="row" id="titulo_header" >
            <div class="col-md-12">
                <div class="page-header" ><h2 id="header_sala">MATRIZ CELULAS INTERMEDIAS</h2></div> 
            </div>
        </div>
        <div>
            <table border="1" style='width: 90%;'>
                <tr>
                    <td style="width: 15%;">
                <label >GESTORES:</label>
                </td>
                <td style="width: 35%;">
                    <select style="width: 95%; text-transform:uppercase; margin-bottom: 10px;" name="ddl04" id="ddl04" >  
                        <option value="0">-- TODOS LOS GESTORES--</option> 
                        {% for entity in usuariosf %}
                            <option value="{{ entity.id}}"> {{entity.username}}</option>
                        {% endfor%}
                    </select>
                </td>
                </tr>
                <tr>
                    <td>
                <label >ESTABLECIMIENTOS:</label>
                </td>
                <td>
                    <select style="width: 95%; text-transform:uppercase; margin-bottom: 10px;" name="ddl01" id="ddl01" >  
                        <option value="0">-- TODOS LOS ESTABLECIMIENTOS--</option> 

                    </select>
                </td>
                </tr>
                 <tr>
                    <td>
                <label >PERIODO:</label>
                </td>
                <td>
                    <select style="width: 95%; text-transform:uppercase; margin-bottom: 10px;" name="ddl02" id="ddl02" >   
                         <option value="2014">-- 2014 --</option> 
                        <option value="2015">-- 2015 --</option> 
                        <option value="2016">-- 2016 --</option>
                        <option value="2017">-- 2017--</option>
                        <option value="2018">-- 2018 --</option>
                        
                    </select>
                </td>
                </tr>
                <br>
                <tr><td>
                    </td>
                    <td >
                        <a class="btn dropdown-toggle btn-primary navbar-btn" href='#' id='btnCargar' name='btnCargar' >
                            <i class="glyphicon glyphicon-cloud-download"></i> <span class="hidden-xs">Cargar</span>
                        </a>
                       <!-- <a  class="btn dropdown-toggle btn-primary navbar-btn"  id='btnExport' name='btnExport'>
                                       <i class="glyphicon glyphicon-open"></i> <span class="hidden-xs">Exportar</span>
                                   </a>-->

                    </td>

                </tr>
            </table>                
        </div>
                     </br></br>
                                       <div id="handsontable" name="handsontable" class="handsontable">
                                           
                                           
                                       </div>
       <div id="sala" >
       </div>
    </form>
</div>
{% endblock %}
